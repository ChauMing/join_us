{"version":3,"sources":["orientHandler.js"],"names":["first","orienter","handler","o","Orienter","latitude","longitude","p","obj","lat","lon","start","Y","X","diffY","diffX","pdiffX","Math","abs","moving","init","pos","orienterStartRotateX","parseFloat","anime","getValue","sliceWrap","orienterStartRotateY","stopOrienter","rotateX","rotateY","$sliceWrap","css","transform","sliceWrapTranslateZ","throttle","requestAnimationFrame","z","stage","tz","a","$stage","$","html"],"mappings":";;AAAA,IAAIA,QAAQ,IAAZ;AACA,SAASC,QAAT,CAAkBC,OAAlB,EAA2B;AACvB,QAAKC,IAAI,IAAIC,QAAJ,EAAT;AACA,QAAIC,WAAW,CAAf;AACA,QAAIC,YAAY,CAAhB;AACA,QAAIC,IAAI,CAAR;AACAJ,MAAED,OAAF,GAAY,UAACM,GAAD,EAAS;AACjB,YAAGR,KAAH,EAAU;AACNK,uBAAWG,IAAIC,GAAf,CADM,CACc;AACpBH,wBAAYE,IAAIE,GAAhB,CAFM,CAEc;AACpBV,oBAAQ,KAAR;AACAE,oBAAQS,KAAR,CAAc;AACVC,mBAAGP,QADO;AAEVQ,mBAAGP;AAFO,aAAd;AAIAC,gBAAID,SAAJ;AACA;AACH;;AAED,YAAIQ,QAAQN,IAAIC,GAAJ,GAAUJ,QAAtB;AACA,YAAIU,QAAQP,IAAIE,GAAJ,GAAUJ,SAAtB;AACA,YAAIU,SAASC,KAAKC,GAAL,CAASZ,YAAYC,CAArB,CAAb;;AAEAL,gBAAQiB,MAAR,CAAe;AACXJ,wBADW;AAEXD,wBAFW;AAGXE;AAHW,SAAf;AAKH,KAtBD;AAuBAb,MAAEiB,IAAF;AACH;;AAEDnB,SAAS;AACLU,WAAO,eAACU,GAAD,EAAS;AACZC,+BAAuBC,WAAWC,MAAMC,QAAN,CAAeC,SAAf,EAA0B,SAA1B,CAAX,CAAvB;AACAC,+BAAuBJ,WAAWC,MAAMC,QAAN,CAAeC,SAAf,EAA0B,SAA1B,CAAX,CAAvB;AACH,KAJI;AAKLP,YAAQ,gBAACE,GAAD,EAAS;;AAGb,YAAGO,iBAAiB,IAApB,EAA0B;AACtB5B,oBAAQ,IAAR;AACA;AACH;;AAGD,YAAI6B,UAAUP,uBAAwBD,IAAIP,KAAJ,GAAU,CAAhD;AACA,YAAIgB,UAAUH,uBAAuBN,IAAIN,KAAzC;;AAEA,YAAGc,UAAU,EAAb,EAAiB;AACbA,sBAAU,EAAV;AACH,SAFD,MAEO,IAAGA,UAAU,CAAC,EAAd,EAAkB;AACrBA,sBAAU,CAAC,EAAX;AACH;;AAEDE,mBAAWC,GAAX,CAAe;AACXC,uCAAyBC,mBAAzB,+CACsBL,OADtB,+CAEsBC,OAFtB;AADW,SAAf;;AAOAK,iBAAS,UAACtB,CAAD,EAAO;;AAEZuB,kCAAsB,YAAM;AACxB,oBAAIC,IAAId,WAAWC,MAAMC,QAAN,CAAea,KAAf,EAAsB,YAAtB,CAAX,CAAR;;AAEA,oBAAIC,KAAKF,IAAIxB,IAAI,CAAjB;AACA,oBAAI2B,IAAI,CAACH,IAAIE,EAAL,IAAY,CAApB;AACAE,uBAAOT,GAAP,CAAW;AACPC,+CAAyBO,CAAzB;AADO,iBAAX;AAGH,aARD;AAUH,SAZD,EAYG,CAZH,EAYM,GAZN,EAYWnB,IAAIL,MAZf;;AAeA0B,UAAE,OAAF,EAAWC,IAAX,YAAyBtB,IAAIN,KAA7B,kBAA+CM,IAAIP,KAAnD;AAEH;AA/CI,CAAT","file":"orientHandler.js","sourcesContent":["let first = true;\nfunction orienter(handler) {\n    let  o = new Orienter();\n    let latitude = 0;\n    let longitude = 0;\n    let p = 0;\n    o.handler = (obj) => {\n        if(first) {\n            latitude = obj.lat; // 维度\n            longitude = obj.lon;// 经度\n            first = false;\n            handler.start({\n                Y: latitude,\n                X: longitude\n            });\n            p = longitude;\n            return;\n        }\n\n        let diffY = obj.lat - latitude;\n        let diffX = obj.lon - longitude;\n        let pdiffX = Math.abs(longitude - p);\n\n        handler.moving({\n            diffX,\n            diffY,\n            pdiffX\n        });\n    }\n    o.init();\n}\n\norienter({\n    start: (pos) => {\n        orienterStartRotateX = parseFloat(anime.getValue(sliceWrap, 'rotateX'));\n        orienterStartRotateY = parseFloat(anime.getValue(sliceWrap, 'rotateY'))\n    }, \n    moving: (pos) => {\n\n\n        if(stopOrienter === true) {\n            first = true;    \n            return;\n        }\n\n\n        let rotateX = orienterStartRotateX + (pos.diffY/2);\n        let rotateY = orienterStartRotateY - pos.diffX;\n\n        if(rotateX > 40) {\n            rotateX = 40;\n        } else if(rotateX < -40) {\n            rotateX = -40;\n        }\n\n        $sliceWrap.css({ \n            transform: `translateZ(${sliceWrapTranslateZ}px)  \n                        rotateX(${rotateX}deg) \n                        rotateY(${rotateY}deg)`,\n        })\n\n\n        throttle((X) => {\n\n            requestAnimationFrame(() => {\n                let z = parseFloat(anime.getValue(stage, 'translateZ'));\n\n                let tz = z - X * 3;\n                let a = (z + tz ) / 2;\n                $stage.css({\n                    transform: `translateZ(${a}px)`\n                })\n            })\n\n        }, 0, 100)(pos.pdiffX);\n\n\n        $('#test').html(`diffX=${pos.diffX}<br>diffY=${pos.diffY}`);\n\n    }\n});\n\n\n\n\n\n\n\n\n\n\n\n"],"sourceRoot":"/source/"}