{"version":3,"sources":["index.js"],"names":["$sliceWrap","$","$stage","sliceWrap","stage","init","str","i","html","$slices","find","each","index","item","css","transform","startRotateY","startRotateX","initTranslateZ","parseInt","anime","getValue","bodyTouchHandler","start","touch","parseFloat","moving","rotateY","diffX","rotateX","diffY","stageRotateX","currentZ","targetZ","absoluteValue","IcanHandlerIt","translateZ","end","window","touchendRotateY","moveToInitZ","requestAnimationFrame","bodyMoving","handler","startX","startY","$body","time","preTime","preDiffX","on","e","touches","clientX","clientY","movingX","movingY","Date","preventDefault","speed","t","moveX","moveY","v"],"mappings":"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","file":"index.js","sourcesContent":["let $sliceWrap = $('.slice-wrap');\nlet $stage = $('.stage');\nlet sliceWrap = $sliceWrap[0];\nlet stage = $stage[0];\n\n\n\n(function init() {\n    let str = '';\n    for(var i = 1; i <= 24; i++) {\n        str += `<div class=\"slice\" style=\"background-image:url(dist\\/img\\/slice/${i}.png)\"></div>`\n    }\n    $sliceWrap.html(str);\n\n\n    let $slices = $sliceWrap.find('.slice');\n\n    $slices.each((index, item) => {\n        $(item).css({\n            transform: `rotateY(${-360/24*index}deg) \n                        translateZ(-489px)`\n        });\n    });\n    $sliceWrap.css({\n        transform: 'translateX(370px) translateZ(500px) translateY(-80px) rotateY(200deg)'\n    })\n}());\n\n\n\n\nlet \n    startRotateY = 0,\n    startRotateX = 0;\n\n\nlet initTranslateZ = parseInt(anime.getValue(stage, 'translateZ'));\n\nlet bodyTouchHandler = {};\n\n\nbodyTouchHandler.start = (touch) => {\n    startRotateX = parseFloat(anime.getValue(stage, 'rotateX'));\n    startRotateY = parseFloat(anime.getValue(sliceWrap, 'rotateY'));\n}\n\nbodyTouchHandler.moving = (touch) => {\n    let \n        rotateY = startRotateY - (touch.diffX / 2880 * 360 * 1.5),\n        rotateX = startRotateX + (touch.diffY / 2880 * 360 * 0.7);\n    \n\n\n    $sliceWrap.css({\n        transform: `translateX(370px) \n                    translateZ(500px) \n                    translateY(-80px) \n                    rotateY(${rotateY}deg)`\n    });\n    let stageRotateX = anime.getValue(stage, 'rotateX');\n\n    let currentZ = parseFloat(anime.getValue(stage, 'translateZ'));\n\n    let targetZ = currentZ - absoluteValue(touch.diffX);\n\n\n    let IcanHandlerIt = anime.getValue(stage, 'rotateX');\n\n    $stage.css({\n        transform: `rotateX(${IcanHandlerIt}) translateZ(${(targetZ - currentZ) * 2}px)`\n    })\n\n    if(rotateX > 40 || rotateX < -40) return;\n    let translateZ = anime.getValue(stage, 'translateZ');\n    $stage.css({\n        transform: `rotateX(${rotateX}deg) translateZ(${(targetZ - currentZ) * 2}px)`\n    });\n\n}\n\nbodyTouchHandler.end = (touch) => {\n    window.touchendRotateY = parseFloat(anime.getValue(sliceWrap, 'rotateY'));\n}\nwindow.touchendRotateY = parseFloat(anime.getValue(sliceWrap, 'rotateY'));\n\n(function moveToInitZ() {\n    \n    requestAnimationFrame(moveToInitZ);\n    let currentZ = parseInt(anime.getValue(stage, 'translateZ'));\n    let rotateX = anime.getValue(stage, 'rotateX');\n\n    if(currentZ < 0) {\n        currentZ /= 3;\n        $stage.css({\n            transform: `rotateX(${rotateX}) translateZ(${currentZ}px)`,\n        })\n    }\n})()\n\nbodyMoving(bodyTouchHandler);\n\nfunction bodyMoving(handler) {\n    let startX = 0;\n    let startY = 0;\n\n\n    let $body = $('body');\n\n    let time = 0;\n    let preTime = 0;\n\n\n    let preDiffX = 0;\n\n    $body.on('touchstart', (e) => {\n        let touch = e.touches[0];\n\n        startX = touch.clientX;\n        startY = touch.clientY;\n\n\n        touch.movingX = touch.clientX;\n        touch.movingY = touch.clientY;\n\n\n        touch.startX = startX;\n        touch.startY = startY;\n        handler.start(touch);\n\n\n        preTime = new Date();\n    });\n\n    $body.on('touchmove', (e) => {\n        e.preventDefault();\n\n        time = new Date();\n\n        let speed = 0,\n            t = time - preTime;\n        preTime = time;\n\n\n\n        let \n            touch = e.touches[0],\n            moveX = touch.clientX,\n            moveY = touch.clientY,\n\n\n            diffX = moveX - startX,\n            diffY = moveY - startY;\n\n        touch.moveX = moveX;\n        touch.moveY = moveY;\n\n        touch.diffX = diffX;\n        touch.diffY = diffY;\n\n\n        speed = absoluteValue(touch.diffX - preDiffX) / t ;\n\n        preDiffX = touch.diffX;\n        touch.speed = speed;\n        handler.moving(touch);\n\n    });\n    $body.on('touchend', (e) => {\n        let touch = e.touches[0];\n        handler.end(touch)\n    })\n}\n\nfunction absoluteValue(v) {\n   return v < 0 ? -v : v; \n}\n\n\n\n"],"sourceRoot":"/source/"}