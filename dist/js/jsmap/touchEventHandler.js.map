{"version":3,"sources":["touchEventHandler.js"],"names":["orienterStartRotateX","orienterStartRotateY","bodyMoving","handler","$body","$","startX","startY","p","on","e","touch","touches","clientX","clientY","start","preventDefault","pdiffX","diffX","diffY","moving","end","moveToInitZ","requestAnimationFrame","currentZ","parseInt","anime","getValue","stage","rotateX","$stage","css","transform","bodyOnTouchHandler","stopOrienter","startRotateY","parseFloat","sliceWrap","startRotateX","rotateY","imageNumber","imageWidth","$sliceWrap","sliceWrapTranslateZ","setTimeout","targetZ","Math","abs","cZ","window"],"mappings":"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","file":"touchEventHandler.js","sourcesContent":["var orienterStartRotateX = 0;\nvar orienterStartRotateY = 0;\n\nfunction bodyMoving(handler) {\n    let $body = $('body');\n\n    let startX = 0;\n    let startY = 0;\n\n\n    let p = 0;\n\n    $body.on('touchstart', (e) => {\n        let touch = e.touches[0];\n\n        startX = touch.clientX;\n        startY = touch.clientY;\n\n        touch.startX = startX;\n        touch.startY = startY;\n\n        handler.start && handler.start(touch);\n\n    });\n\n    $body.on('touchmove', (e) => {\n        e.preventDefault();\n\n        let touch = e.touches[0];\n\n        touch.pdiffX = touch.clientX - p;\n        p = touch.clientX;\n\n        touch.diffX = touch.clientX - startX;\n        touch.diffY = touch.clientY - startY;\n\n        handler.moving && handler.moving(touch);\n\n    });\n    $body.on('touchend', (e) => {\n        let touch = e.touches[0];\n        handler.end && handler.end(touch)\n    });\n}\n(function moveToInitZ() {\n    \n    requestAnimationFrame(moveToInitZ);\n    let currentZ = parseInt(anime.getValue(stage, 'translateZ'));\n    let rotateX = anime.getValue(stage, 'rotateX');\n\n\n    if(currentZ <= 0) {\n        currentZ /= 2;\n        $stage.css({\n            transform: `rotateX(${rotateX}) translateZ(${currentZ}px)`,\n        })\n    }\n})()\n\nconst bodyOnTouchHandler = {};\n\nbodyOnTouchHandler.start = function(touch) {\n    stopOrienter = true;\n    this.startRotateY = parseFloat(anime.getValue(sliceWrap, 'rotateY'));\n    this.startRotateX = parseFloat(anime.getValue(stage, 'rotateX'));\n}\n\nbodyOnTouchHandler.moving = function(touch) {\n\n    let rotateY = this.startRotateY - (touch.diffX / (imageNumber * imageWidth) * 360 * 1.5);\n    let rotateX = this.startRotateX - (touch.diffY / (imageNumber * imageWidth) * 360 * 1.5);\n\n    if(rotateX > 40) {\n        rotateX = 40;\n    } else if(rotateX < -40) {\n        rotateX = -40;\n    }\n\n\n    $sliceWrap.css({\n        transform: `translateZ(${sliceWrapTranslateZ}px) rotateY(${rotateY}deg)`,\n    });\n\n\n    setTimeout(() => {\n        let currentZ = parseFloat(anime.getValue(stage, 'translateZ'));\n        let targetZ = currentZ - Math.abs(touch.diffX);\n        let cZ = targetZ - currentZ;\n\n\n        $stage.css({\n            transform: `rotateX(${rotateX}deg) translateZ(${(cZ)/1.5}px)`\n        });\n    }, 0)\n};\n\n\nbodyOnTouchHandler.end = function() {\n    window.orienterStartRotateX = parseFloat(anime.getValue(stage, 'rotateX'));\n    window.orienterStartRotateY = parseFloat(anime.getValue(sliceWrap, 'rotateY'));\n    stopOrienter = false;\n}\n\n\nbodyMoving(bodyOnTouchHandler);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"sourceRoot":"/source/"}